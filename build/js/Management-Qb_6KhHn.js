import{j as e,i as ke,k as Se,f as oe,l as Ee,F as Ie}from"../assets/index-BWgrvNut.js";import{r as u}from"./chunk-CTJ-xxG2.js";import{a as N}from"./chunk-ngrFHoWO.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-nx6VVHRj.js";const Be=()=>{var ae;const[w,I]=u.useState([]),[P,L]=u.useState(!0),[R,G]=u.useState(""),[J,Y]=u.useState([]),[H,Q]=u.useState(!1),[D,X]=u.useState(""),[le,C]=u.useState(!1),[b,U]=u.useState(""),[x,A]=u.useState(null),[h,j]=u.useState({name:"",description:"",price:"",instructor:"",image:null,lessons:[{videoFiles:[],lessonNumber:"",lessonIntro:""}]}),[B,S]=u.useState({}),[Z,_]=u.useState({}),[z,K]=u.useState({}),[g,E]=u.useState({}),[T,ee]=u.useState(null),[k,se]=u.useState(!1),[te,$]=u.useState(0),[y,ie]=u.useState(1),W=5;u.useEffect(()=>{q(),ce()},[]),u.useEffect(()=>{const s="wss://cpsangeetha.com/upload-progress",t=new WebSocket(s);return t.onopen=()=>{console.log("📡 Connected to upload progress WebSocket"),ee(t)},t.onmessage=a=>{try{const r=JSON.parse(a.data);if(console.log("📡 Received WebSocket message:",r),r.type==="progress"&&r.uploadId){const l=Object.keys(g).find(o=>{var d;return((d=g[o])==null?void 0:d.uploadId)===r.uploadId});l&&(_(o=>({...o,[l]:r.percentage})),E(o=>({...o,[l]:{...o[l],uploadedMB:Math.round(r.uploadedBytes/1024/1024),totalMB:Math.round(r.fileSize/1024/1024),currentSpeed:r.speed,eta:r.eta,elapsed:Math.round((Date.now()-r.startTime)/1e3),uploadId:r.uploadId}})))}else if(r.type==="progress"&&r.status==="completed"){const l=Object.keys(g).find(o=>{var d;return((d=g[o])==null?void 0:d.uploadId)===r.uploadId});l&&(S(o=>({...o,[l]:!1})),E(o=>{const d={...o};return delete d[l],d}))}}catch(r){console.error("Error parsing WebSocket message:",r)}},t.onclose=()=>{console.log("📡 WebSocket connection closed"),ee(null)},t.onerror=a=>{console.error("WebSocket error:",a)},()=>{t.close()}},[g]),u.useEffect(()=>()=>{Object.entries(z).forEach(([s,t])=>{B[s]&&(t.abort(),console.log(`Cancelled upload ${s} on unmount`))})},[z,B]),u.useEffect(()=>{if(!k)return;const s=setInterval(()=>{$(t=>{const a=Math.min(t+5,95);return t>=95?95:a})},500);return()=>clearInterval(s)},[k]);const v=async s=>{var t;try{const a=await s;return console.log("API Response:",a.data),a}catch(a){throw console.error("API Error:",((t=a.response)==null?void 0:t.data)||a.message),a}},q=async()=>{L(!0),G("");try{const s=await v(N.get("https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses"));I(s.data||[])}catch{G("Failed to load courses")}finally{L(!1)}},ce=async()=>{Q(!0),X("");try{const s=await v(N.get("https://cpsangeetha.com/chinthanaprabha/teacher-auth/teachers"));Y(s.data||[])}catch{X("Failed to load instructors"),Y([])}finally{Q(!1)}},de=async(s,t,a)=>{var o,d,n,m,i;const r=new AbortController;K(c=>({...c,[t]:r})),S(c=>({...c,[t]:!0})),_(c=>({...c,[t]:0}));const l=`upload_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;E(c=>({...c,[t]:{uploadedMB:0,totalMB:Math.round(s.size/1024/1024),currentSpeed:0,eta:0,elapsed:0,fileName:s.name,startTime:Date.now(),uploadId:l}})),T&&T.readyState===WebSocket.OPEN&&T.send(JSON.stringify({type:"subscribe",uploadId:l}));try{if(!s.type.startsWith("video/"))throw new Error(`${s.name} is not a valid video file`);if(s.size>10*1024*1024*1024)throw new Error(`${s.name} exceeds 10GB limit`);const c=new FormData;c.append("video",s),c.append("uploadId",l);const p=await N.post(a,c,{headers:{"Content-Type":"multipart/form-data"},signal:r.signal,timeout:72e5});if(!((o=p.data)!=null&&o.location))throw new Error("Upload failed: No location returned from server");return S(f=>({...f,[t]:!1})),E(f=>{const ne={...f};return delete ne[t],ne}),p.data.location}catch(c){throw S(p=>({...p,[t]:!1})),c.name==="AbortError"?new Error("Upload cancelled"):c.code==="ECONNABORTED"?new Error(`Upload timeout for ${s.name}. Large files may take longer. Please try again.`):((d=c.response)==null?void 0:d.status)===413?new Error(`${s.name} is too large. Maximum size is 10GB.`):((n=c.response)==null?void 0:n.status)>=500?new Error(`Server error uploading ${s.name}. Please try again later.`):new Error(((i=(m=c.response)==null?void 0:m.data)==null?void 0:i.error)||c.message||`Failed to upload ${s.name}`)}finally{K(c=>{const p={...c};return delete p[t],p})}},me=async(s,t)=>{const a=Array.from(t.target.files);if(!a.length)return;const r=[],l=a.filter(o=>o.type.startsWith("video/")?o.size>10*1024*1024*1024?(r.push(`${o.name} exceeds 10GB limit`),!1):!0:(r.push(`${o.name} is not a video file`),!1));if(r.length>0&&alert(`File validation errors:
${r.join(`
`)}`),l.length===0){t.target.value="";return}try{const o=l.map(async(i,c)=>{const p=`lesson-${s}-file-${Date.now()}-${c}`;try{const f=await de(i,p,"https://cpsangeetha.com/chinthanaprabha/upload-video");return{name:i.name,size:i.size,type:i.type,url:f,success:!0}}catch(f){return console.error(`Failed to upload ${i.name}:`,f),{name:i.name,size:i.size,type:i.type,error:f.message,success:!1}}}),d=await Promise.all(o),n=d.filter(i=>i.success),m=d.filter(i=>!i.success);if(n.length>0&&j(i=>({...i,lessons:i.lessons.map((c,p)=>p===s?{...c,videoFiles:[...c.videoFiles||[],...n]}:c)})),n.length>0&&m.length===0)alert(`Successfully uploaded ${n.length} video(s)`);else if(n.length>0&&m.length>0){const i=m.map(c=>c.name).join(", ");alert(`Uploaded ${n.length} video(s) successfully.
Failed: ${i}`)}else{const i=m.map(c=>c.name).join(", ");alert(`All uploads failed:
${i}`)}}catch(o){console.error("Unexpected error during upload:",o),alert(`Unexpected error: ${o.message}`)}finally{t.target.value=""}},ue=(s,t)=>{j(a=>({...a,lessons:a.lessons.map((r,l)=>l===s?{...r,videoFiles:r.videoFiles.filter((o,d)=>d!==t)}:r)}))},he=s=>{window.confirm("Remove all videos from this lesson?")&&j(t=>({...t,lessons:t.lessons.map((a,r)=>r===s?{...a,videoFiles:[]}:a)}))},pe=s=>{const t=z[s];t&&(t.abort(),S(a=>({...a,[s]:!1})),_(a=>({...a,[s]:0})),E(a=>{const r={...a};return delete r[s],r}),alert("Upload cancelled"))},F=(s,t=-1)=>{const{name:a,value:r,files:l}=s.target;j(a==="image"?o=>({...o,image:l[0]}):t===-1?o=>({...o,[a]:r}):o=>({...o,lessons:o.lessons.map((d,n)=>n===t?{...d,[a]:r}:d)}))},xe=()=>{j(s=>({...s,lessons:[...s.lessons,{videoFiles:[],lessonNumber:"",lessonIntro:""}]}))},ge=s=>{j(t=>({...t,lessons:t.lessons.filter((a,r)=>r!==s)}))},fe=()=>{U("add"),A(null),j({name:"",description:"",price:"",instructor:"",image:null,lessons:[{videoFiles:[],lessonNumber:"",lessonIntro:""}]}),C(!0)},be=s=>{var t,a;U("edit"),A(s),j({name:s.name||"",description:s.description||"",price:s.price||"",instructor:((t=s.instructor)==null?void 0:t._id)||s.instructor||"",image:null,currentImage:s.image,lessons:(a=s.lessons)!=null&&a.length?s.lessons.map(r=>{var l;return{lessonNumber:r.lessonNumber||"",lessonIntro:r.lessonIntro||"",videoFiles:((l=r.videoUrls)==null?void 0:l.map(o=>({url:o,name:o.split("/").pop(),size:0,type:"video/mp4"})))||[],_id:r._id}}):[{videoFiles:[],lessonNumber:"",lessonIntro:""}]}),C(!0)},je=s=>{U("view"),A(s),C(!0)},Ne=async s=>{if(confirm("Are you sure you want to delete this course?"))try{await v(N.delete(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${s}`)),I(w.filter(t=>t._id!==s))}catch{alert("Failed to delete course")}},ve=s=>{const t=[],a=s.map(l=>l.lessonNumber).filter(Boolean),r=a.filter((l,o)=>a.indexOf(l)!==o);return r.length>0&&t.push(`Duplicate lesson numbers found: ${[...new Set(r)].join(", ")}`),s.forEach((l,o)=>{var d,n,m;(d=l.lessonNumber)!=null&&d.trim()||t.push(`Lesson ${o+1}: Lesson number is required`),(n=l.lessonIntro)!=null&&n.trim()||t.push(`Lesson ${o+1}: Lesson intro is required`),(!((m=l.videoFiles)!=null&&m.length)||l.videoFiles.every(i=>!i.url))&&t.push(`Lesson ${o+1}: At least one video is required`)}),t},ye=async(s,t)=>{var l,o,d;if(!((l=s.lessonNumber)!=null&&l.trim())||!((o=s.lessonIntro)!=null&&o.trim()))throw new Error(`Lesson ${s.lessonNumber||"Unknown"}: Missing required fields`);const a=new FormData;a.append("lessonNumber",s.lessonNumber),a.append("lessonIntro",s.lessonIntro);const r=(d=s.videoFiles)==null?void 0:d.map(n=>n.url).filter(Boolean);if(!r||r.length===0)throw new Error(`Lesson ${s.lessonNumber}: At least one video is required`);return r.forEach(n=>a.append("videoUrls",n)),s._id?await v(N.put(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/lessons/${s._id}`,a,{headers:{"Content-Type":"multipart/form-data"}})):await v(N.post(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${t}/lessons`,a,{headers:{"Content-Type":"multipart/form-data"}}))},we=async s=>{if(s.preventDefault(),!h.name||!h.description||!h.price||!h.instructor){alert("Please fill in all required fields");return}if(b==="add"&&!h.image){alert("Please select a course image");return}const t=ve(h.lessons);if(t.length>0){alert(`Please fix the following errors:
${t.join(`
`)}`);return}se(!0),$(0);let a=null;try{const r=new FormData;r.append("name",h.name),r.append("description",h.description),r.append("price",h.price),r.append("instructor",h.instructor),h.image&&r.append("thumbnail",h.image),b==="add"?(a=(await v(N.post("https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses",r,{headers:{"Content-Type":"multipart/form-data"}}))).data._id,$(30)):(a=x._id,await v(N.put(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${a}`,r,{headers:{"Content-Type":"multipart/form-data"}})),$(30));const l=h.lessons.filter(n=>{var m,i,c;return((m=n.lessonNumber)==null?void 0:m.trim())&&((i=n.lessonIntro)==null?void 0:i.trim())&&((c=n.videoFiles)==null?void 0:c.length)>0});if(l.length===0)throw new Error("No valid lessons to process");const o=50/l.length;let d=30;for(let n=0;n<l.length;n++){const m=l[n];try{await ye(m,a),d+=o,$(Math.round(d))}catch(i){throw console.error(`Failed to process lesson ${m.lessonNumber}:`,i),new Error(`Failed to process lesson ${m.lessonNumber}: ${i.message}`)}}if(b==="edit"&&x.lessons){const n=h.lessons.filter(i=>i._id).map(i=>i._id),m=x.lessons.filter(i=>!n.includes(i._id));for(const i of m)try{await v(N.delete(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/lessons/${i._id}`))}catch(c){console.error(`Failed to delete lesson ${i._id}:`,c)}}$(100),alert(b==="add"?"Course added successfully!":"Course updated successfully!"),C(!1),await q()}catch(r){if(console.error("Course submission error:",r),b==="add"&&a)try{await v(N.delete(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${a}`)),console.log("Rolled back course creation due to error")}catch(l){console.error("Failed to rollback course creation:",l)}alert(`Error saving course: ${r.message}`)}finally{se(!1),$(0)}},re=y*W,Ce=re-W,$e=(w||[]).slice(Ce,re),M=Math.ceil((w||[]).length/W),O=s=>ie(s),Fe=s=>{if(s===0)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(t));return`${(s/Math.pow(t,r)).toFixed(2)} ${a[r]}`};return e.jsxs("div",{className:"h-screen p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Course Management"}),e.jsx("button",{onClick:fe,className:"bg-black text-white px-4 py-2 rounded",children:"Add New Course"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:P?e.jsx("div",{className:"p-8 text-center",children:"Loading courses..."}):R?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:R}),e.jsx("button",{onClick:q,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Retry"})]}):(w||[]).length===0?e.jsx("div",{className:"p-8 text-center",children:"No courses found. Add your first course!"}):e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-800 text-white",children:[e.jsx("th",{className:"w-16 px-4 py-2 text-center",children:"ID"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center",children:"Image"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Instructor"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center",children:"Videos"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center",children:"Lessons"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center",children:"Price"}),e.jsx("th",{className:"w-32 px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:$e.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"px-4 py-2",children:s._id.substring(0,6)}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(V,{image:s.image,name:s.name})}),e.jsx("td",{className:"px-4 py-2",children:s.name}),e.jsx("td",{className:"px-4 py-2",children:((t=s.instructor)==null?void 0:t.name)||"N/A"}),e.jsx("td",{className:"px-4 py-2",children:(s.lessons||[]).reduce((a,r)=>{var l;return a+(((l=r.videoUrls)==null?void 0:l.length)||0)},0)}),e.jsx("td",{className:"px-4 py-2",children:(s.lessons||[]).length}),e.jsxs("td",{className:"px-4 py-2",children:["₹",s.price]}),e.jsxs("td",{className:"px-4 py-2 space-x-3 text-right",children:[e.jsx("button",{onClick:()=>je(s),className:"text-indigo-600 hover:text-indigo-900",children:e.jsx(ke,{size:18})}),e.jsx("button",{onClick:()=>be(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(Se,{size:18})}),e.jsx("button",{onClick:()=>Ne(s._id),className:"text-red-600 hover:text-red-900",children:e.jsx(oe,{size:18})})]})]},s._id)})})]})}),e.jsx("div",{className:"flex justify-end mt-4 mb-4 pr-4",children:e.jsxs("nav",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>O(Math.max(1,y-1)),disabled:y===1,className:`px-3 py-1 mx-1 rounded ${y===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:"Previous"}),Array.from({length:M},(s,t)=>t+1).map(s=>e.jsx("button",{onClick:()=>O(s),className:`px-3 py-1 mx-1 rounded ${y===s?"bg-black text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:s},s)),e.jsx("button",{onClick:()=>O(Math.min(M,y+1)),disabled:y===M,className:`px-3 py-1 mx-1 rounded ${y===M?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:"Next"})]})}),le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg max-h-[85vh] overflow-y-auto",children:[e.jsx("button",{onClick:()=>C(!1),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-left",children:b==="view"?"Course Details":b==="add"?"Add New Course":"Edit Course"}),b==="view"&&x?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Course Image"}),e.jsx(V,{image:x.image,name:x.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Course Name"}),e.jsx("p",{children:x.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Description"}),e.jsx("p",{children:x.description})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Instructor"}),e.jsx("p",{children:((ae=x.instructor)==null?void 0:ae.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Price"}),e.jsxs("p",{children:["₹",x.price]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Lessons"}),e.jsx("ul",{className:"list-disc pl-5",children:(x.lessons||[]).map((s,t)=>e.jsxs("li",{children:["Lesson ",s.lessonNumber,": ",s.lessonIntro]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Videos"}),(()=>{const s=(x.lessons||[]).flatMap(t=>(t.videoUrls||[]).map((a,r)=>e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-2",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Lesson ",t.lessonNumber," - Video ",r+1]}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:a}),e.jsx("video",{src:a,controls:!0,className:"w-full h-64 mt-2 rounded-lg",preload:"metadata",children:"Your browser does not support the video tag."})]},`${t.lessonNumber}-${r}`)));return s.length>0?s:e.jsx("p",{className:"text-gray-500",children:"No videos available."})})()]}),e.jsx("button",{onClick:()=>C(!1),className:"w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Close"})]}):e.jsxs("form",{onSubmit:we,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left",children:"Course Image"}),e.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:F,className:"mt-1 w-full"}),b==="edit"&&h.currentImage&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Current image:"}),e.jsx(V,{image:h.currentImage,name:h.name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left",children:"Course Name"}),e.jsx("input",{type:"text",name:"name",value:h.name,onChange:F,className:"mt-1 w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left",children:"Description"}),e.jsx("textarea",{name:"description",value:h.description,onChange:F,rows:3,className:"mt-1 w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left",children:"Instructor"}),e.jsxs("select",{name:"instructor",value:h.instructor,onChange:F,className:"mt-1 w-full px-3 py-2 border rounded-md",required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:H?"Loading...":"Select an instructor"}),D&&e.jsx("option",{value:"",disabled:!0,children:D}),!H&&!D&&(J||[]).length===0&&e.jsx("option",{value:"",disabled:!0,children:"No instructors found"}),(J||[]).map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left",children:"Price"}),e.jsx("input",{type:"number",name:"price",value:h.price,onChange:F,className:"mt-1 w-full px-3 py-2 border rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left",children:"Lessons"}),(h.lessons||[]).map((s,t)=>{var a,r,l,o,d;return e.jsxs("div",{className:"mt-4 p-4 border rounded-md",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsxs("h4",{className:"text-lg font-medium",children:["Lesson ",t+1]}),e.jsx("button",{type:"button",onClick:()=>ge(t),className:"text-red-600 hover:text-red-800",children:e.jsx(Ee,{})})]}),e.jsx("input",{type:"text",placeholder:"Lesson Number",name:"lessonNumber",value:s.lessonNumber,onChange:n=>F(n,t),className:`w-full px-3 py-2 border rounded-md mb-2 ${(a=s.lessonNumber)!=null&&a.trim()?"border-gray-300":"border-red-300 bg-red-50"}`,required:!0}),e.jsx("input",{type:"text",placeholder:"Lesson Intro",name:"lessonIntro",value:s.lessonIntro,onChange:n=>F(n,t),className:`w-full px-3 py-2 border rounded-md mb-2 ${(r=s.lessonIntro)!=null&&r.trim()?"border-gray-300":"border-red-300 bg-red-50"}`,required:!0}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium text-left ${!((l=s.videoFiles)!=null&&l.length)||s.videoFiles.every(n=>!n.url)?"text-red-600":"text-gray-700"}`,children:["Videos (Up to 10GB) ",(!((o=s.videoFiles)!=null&&o.length)||s.videoFiles.every(n=>!n.url))&&"*"]}),e.jsx("input",{type:"file",accept:"video/*",multiple:!0,onChange:n=>me(t,n),className:"mt-1 w-full"}),Object.keys(B).filter(n=>n.startsWith(`lesson-${t}-`)).map(n=>{var m,i,c,p,f;return e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"📹 Uploading video..."}),e.jsx("button",{onClick:()=>pe(n),className:"text-red-600 hover:text-red-800 font-medium",children:"Cancel"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:`${Z[n]||0}%`}})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-700",children:[Z[n]||0,"%"]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("span",{className:"inline-block mr-3",children:["📊 Speed: ",e.jsxs("span",{className:"font-mono",children:[((m=g[n])==null?void 0:m.currentSpeed)||"--"," MB/s"]})]}),e.jsxs("span",{className:"inline-block",children:["⏱️ ETA: ",e.jsxs("span",{className:"font-mono",children:[((i=g[n])==null?void 0:i.eta)||"--","s"]})]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["💾 Size: ",e.jsxs("span",{className:"font-mono",children:[((c=g[n])==null?void 0:c.uploadedMB)||"--"," MB / ",((p=g[n])==null?void 0:p.totalMB)||"--"," MB"]}),((f=g[n])==null?void 0:f.elapsed)&&e.jsxs("span",{className:"ml-3",children:["⏰ Elapsed: ",e.jsxs("span",{className:"font-mono",children:[g[n].elapsed,"s"]})]})]})]},n)}),((d=s.videoFiles)==null?void 0:d.length)>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("p",{children:["Added Videos (",s.videoFiles.length,")"]}),e.jsx("button",{type:"button",onClick:()=>he(t),className:"text-red-600 hover:text-red-800",children:"Clear All"})]}),s.videoFiles.map((n,m)=>e.jsxs("div",{className:"flex justify-between mt-1 bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"truncate",children:[n.name," (",Fe(n.size),")",n.url&&e.jsx("span",{className:"ml-1 text-green-600",children:"(Uploaded)"})]}),e.jsx("button",{type:"button",onClick:()=>ue(t,m),className:"text-red-600 hover:text-red-800",children:e.jsx(oe,{size:14})})]},m))]})]})]},t)}),e.jsxs("button",{type:"button",onClick:xe,className:"mt-2 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:[e.jsx(Ie,{className:"inline-block mr-2"})," Add Lesson"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"submit",disabled:k,className:`flex-1 px-4 py-2 rounded text-white ${k?"bg-blue-300":"bg-blue-500 hover:bg-blue-600"}`,children:k?`Processing... ${te}%`:b==="add"?"Add Course":"Update Course"}),k&&e.jsx("div",{className:"w-40",children:e.jsx("div",{className:"h-2 bg-gray-200 rounded",children:e.jsx("div",{className:"h-2 bg-blue-600 rounded",style:{width:`${te}%`}})})}),e.jsx("button",{type:"button",onClick:()=>C(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})]})})]})},V=({image:w,name:I})=>{const[P,L]=u.useState(!1);return e.jsx("img",{src:P||!w?"/placeholder.svg":w,alt:I,className:"h-10 w-10 rounded-full",onError:()=>L(!0)})};export{Be as default};
