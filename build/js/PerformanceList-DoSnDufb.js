import{j as e,F as P,k as S,f as M,h as N}from"../assets/index-CSJBBbQo.js";import{r}from"./chunk-CTJ-xxG2.js";import{a as E}from"./chunk-ngrFHoWO.js";import{y as o}from"./chunk-B_gl6WRw.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-nx6VVHRj.js";const R=()=>{const[g,w]=r.useState([]),[v,d]=r.useState(!1),[k,c]=r.useState(!1),[s,C]=r.useState(null),[m,y]=r.useState({open:!1,type:"",url:""}),[a,u]=r.useState({title:"",name:"",skillLevel:"beginner",video:null,photo:null,thumbnail:null}),x=E.create({baseURL:"https://cpsangeetha.com/api"});r.useEffect(()=>{h()},[]),console.log(g,"performances");const h=async()=>{d(!0);try{const t=await x.get("/performance");w(t.data)}catch{o.error("Failed to fetch performances")}finally{d(!1)}},L=async t=>{if(window.confirm("Are you sure you want to delete this performance?"))try{await x.delete(`/performance/${t}`),o.success("Performance deleted successfully"),h()}catch{o.error("Failed to delete performance")}},n=(t,l)=>{const i=getMediaUrl(l);if(!i){o.error("Media URL is not available");return}y({open:!0,type:t,url:i})},p=t=>{const{name:l,value:i}=t.target;u(f=>({...f,[l]:i}))},b=t=>{const{name:l,files:i}=t.target;u(f=>({...f,[l]:i[0]}))},F=async t=>{t.preventDefault(),d(!0);const l=new FormData;l.append("title",a.title),l.append("name",a.name),l.append("skillLevel",a.skillLevel),a.video&&l.append("video",a.video),a.photo&&l.append("photo",a.photo),a.thumbnail&&l.append("thumbnail",a.thumbnail);try{s?(await x.put(`/performance/${s._id}`,l),o.success("Performance updated successfully")):(await x.post("/performance",l),o.success("Performance created successfully")),h(),c(!1)}catch{o.error("Error saving performance")}finally{d(!1)}},j=(t=null)=>{C(t),u({title:(t==null?void 0:t.title)||"",name:(t==null?void 0:t.name)||"",skillLevel:(t==null?void 0:t.skillLevel)||"beginner",video:null,photo:null,thumbnail:null}),c(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Performance Management"}),e.jsxs("button",{onClick:()=>j(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center transition-colors duration-200",children:[e.jsx(P,{className:"mr-2"}),"Add Performance"]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Performer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Media"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Skill Level"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-4 text-sm font-medium text-gray-900 sm:px-6",children:t.title}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:t.name}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-4 space-y-4 sm:space-y-0",children:[t.photo&&e.jsx("div",{className:"relative cursor-pointer group",onClick:()=>n("image",t.photo),children:e.jsx("img",{src:t.photo,alt:`${t.title} photo`,className:"w-full max-w-[150px] h-20 object-cover rounded border border-gray-300 group-hover:border-blue-500 transition-colors duration-200"})}),t.video&&e.jsx("div",{className:"relative cursor-pointer group",onClick:()=>n("video",t.video),children:e.jsxs("video",{className:"w-full max-w-[150px] h-20 object-cover rounded border border-gray-300 group-hover:border-blue-500 transition-colors duration-200",muted:!0,children:[e.jsx("source",{src:t.video,type:"video/mp4"}),"Your browser does not support the video tag."]})}),t.thumbnail&&e.jsx("div",{className:"relative cursor-pointer group",onClick:()=>n("image",t.thumbnail),children:e.jsx("img",{src:t.thumbnail,alt:`${t.title} thumbnail`,className:"w-full max-w-[150px] h-20 object-cover rounded border border-gray-300 group-hover:border-blue-500 transition-colors duration-200"})})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.skillLevel==="beginner"?"bg-green-100 text-green-800":t.skillLevel==="intermediate"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.skillLevel.charAt(0).toUpperCase()+t.skillLevel.slice(1)})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>j(t),className:"text-blue-600 hover:text-blue-900 transition-colors duration-200","aria-label":"Edit performance",children:e.jsx(S,{})}),e.jsx("button",{onClick:()=>L(t._id),className:"text-red-600 hover:text-red-900 transition-colors duration-200","aria-label":"Delete performance",children:e.jsx(M,{})})]})})]},t._id))})]})})}),m.open&&e.jsx("div",{className:"fixed inset-0 z-150 overflow-y-auto bg-black bg-opacity-75 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg max-w-4xl w-full",children:[e.jsx("button",{onClick:()=>y({open:!1,type:"",url:""}),className:"absolute top-4 right-4 text-gray-600 hover:text-gray-800 z-10","aria-label":"Close preview",children:e.jsx(N,{className:"h-6 w-6"})}),e.jsx("div",{className:"p-4",children:m.type==="video"?e.jsxs("video",{controls:!0,autoPlay:!0,className:"w-full max-h-[80vh] rounded",children:[e.jsx("source",{src:m.url,type:"video/mp4"}),"Your browser does not support the video tag."]}):e.jsx("img",{src:m.url,alt:"Preview",className:"w-full max-h-[80vh] object-contain rounded"})})]})}),k&&e.jsx("div",{className:"fixed inset-0 inset-0 bg-black/30 backdrop-blur-md z-140 transition-opacity duration-300  overflow-y-auto  bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg w-full max-w-md sm:max-w-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-medium text-gray-900",children:s?"Edit Performance":"Add New Performance"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-600 hover:text-gray-800","aria-label":"Close form",children:e.jsx(N,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",name:"title",id:"title",value:a.title,onChange:p,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Performer Name"}),e.jsx("input",{type:"text",name:"name",id:"name",value:a.name,onChange:p,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"skillLevel",className:"block text-sm font-medium text-gray-700",children:"Skill Level"}),e.jsxs("select",{id:"skillLevel",name:"skillLevel",value:a.skillLevel,onChange:p,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"video",className:"block text-sm font-medium text-gray-700",children:["Video File",(s==null?void 0:s.video)&&e.jsx("button",{type:"button",onClick:()=>n("video",s.video),className:"ml-2 text-blue-600 text-xs hover:underline",children:"(View current)"})]}),e.jsx("input",{type:"file",name:"video",id:"video",onChange:b,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"video/*"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"photo",className:"block text-sm font-medium text-gray-700",children:["Photo",(s==null?void 0:s.photo)&&e.jsx("button",{type:"button",onClick:()=>n("image",s.photo),className:"ml-2 text-blue-600 text-xs hover:underline",children:"(View current)"})]}),e.jsx("input",{type:"file",name:"photo",id:"photo",onChange:b,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"image/*"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700",children:["Thumbnail",(s==null?void 0:s.thumbnail)&&e.jsx("button",{type:"button",onClick:()=>n("image",s.thumbnail),className:"ml-2 text-blue-600 text-xs hover:underline",children:"(View current)"})]}),e.jsx("input",{type:"file",name:"thumbnail",id:"thumbnail",onChange:b,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"image/*"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Saving...":s?"Update":"Save"})]})]})]})})]})};export{R as default};
