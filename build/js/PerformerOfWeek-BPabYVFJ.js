import{j as e,o as w,F as v,m as u,k as T,f as L}from"../assets/index-5RbimExn.js";import{r as n}from"./chunk-CTJ-xxG2.js";import{d as N}from"./chunk-UKrXCPbE.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-ngrFHoWO.js";import"./chunk-nx6VVHRj.js";const H=()=>{const[l,m]=n.useState([]),[f,p]=n.useState(!0),[b,y]=n.useState(null),[P,c]=n.useState(!1),[i,g]=n.useState(null),[a,d]=n.useState({title:"",category:"",imageFile:null,imagePreview:""}),x=async()=>{try{p(!0);const t=await fetch("https://cpsangeetha.com/chinthanaprabha/performer/performers");if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const s=(await t.json()).map((h,C)=>({...h,featured:C===0}));m(s),y(null)}catch(t){console.error("Error fetching performers:",t),y("Failed to load performers. Please try again later.")}finally{p(!1)}};n.useEffect(()=>{x()},[]);const F=async t=>{if(t.preventDefault(),!a.title.trim()){alert("Please enter a student name");return}if(!a.category.trim()){alert("Please enter a course name");return}if(!i&&!a.imageFile){alert("Please select an image file");return}try{const r=new FormData;r.append("title",a.title),r.append("category",a.category),a.imageFile&&r.append("image",a.imageFile);let s;if(i?s=await fetch(`https://cpsangeetha.com/chinthanaprabha/performer/performers/${i._id}`,{method:"PUT",body:r}):(console.log("Sending new performer data:",{title:a.title,category:a.category,hasImage:!!a.imageFile}),s=await fetch("https://cpsangeetha.com/chinthanaprabha/performer/performers",{method:"POST",body:r})),!s.ok){const h=await s.text();throw console.error("Server response:",h),new Error(`HTTP error! Status: ${s.status}`)}alert(i?"Performer updated successfully!":"New performer added successfully!"),x(),c(!1),g(null),d({title:"",category:"",imageFile:null,imagePreview:""})}catch(r){console.error("Error saving performer:",r),alert("Failed to save performer. Please try again.")}},k=t=>{g(t),d({title:t.title,category:t.category,imageFile:null,imagePreview:t.image.startsWith("http")?t.image:`${t.image}`}),c(!0)},D=async t=>{if(window.confirm("Are you sure you want to delete this performer?"))try{const r=await fetch(`https://cpsangeetha.com/chinthanaprabha/performer/performers/${t}`,{method:"DELETE"});if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);m(l.filter(s=>s._id!==t))}catch(r){console.error("Error deleting performer:",r),alert("Failed to delete performer. Please try again.")}},E=t=>{m(l.map(r=>({...r,featured:r._id===t})))},S=t=>{if(t.target.files&&t.target.files[0]){const r=t.target.files[0];d({...a,imageFile:r,imagePreview:URL.createObjectURL(r)})}},j=()=>{c(!1),g(null),d({title:"",category:"",imageFile:null,imagePreview:""})};if(f&&l.length===0)return e.jsx("div",{className:"p-6 flex items-center justify-center min-h-[300px]",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 mb-4"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"})]})});if(b&&l.length===0)return e.jsx("div",{className:"p-6 text-center",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:b}),e.jsx("button",{onClick:x,className:"mt-2 text-sm bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded transition-colors",children:"Try Again"})]})});const o=l.find(t=>t.featured);return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center",children:[e.jsx(w,{className:"text-yellow-500 mr-2"}),"Performer of the Week"]}),e.jsxs("button",{onClick:()=>c(!0),className:"bg-gradient-to-b from-[#0D0D0D] via-[#8B0000] to-[#0D0D0D] text-white px-4 py-2 rounded-lg shadow-md transition-colors flex items-center",children:[e.jsx(v,{className:"mr-2"})," Add New Performer"]})]}),o&&e.jsxs("div",{className:"bg-gradient-to-b from-[#0D0D0D] via-[#8B0000] to-[#0D0D0D] text-white p-8 rounded-2xl shadow-xl mb-8 transform hover:scale-[1.01] transition-transform",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"bg-yellow-400 p-2 rounded-full",children:e.jsx(u,{className:"text-indigo-900 text-xl"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Featured Performer"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-yellow-300 to-yellow-500 rounded-full transform scale-110 opacity-50 blur-md"}),e.jsx("img",{src:o.image.startsWith("http")?o.image:`${o.image}`,alt:o.title,className:"w-40 h-40 rounded-full object-cover border-4 border-white shadow-lg relative z-10",onError:t=>{t.target.src=N}})]}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:o.title}),e.jsx("p",{className:"text-lg text-indigo-100 mb-4",children:o.category}),e.jsx("p",{className:"text-sm text-indigo-200",children:"Recognized for outstanding performance and dedication"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(t=>e.jsxs("div",{className:`bg-white rounded-xl shadow-md overflow-hidden transition-all hover:shadow-lg ${t.featured?"ring-2 ring-yellow-400 ring-offset-2":""}`,children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:t.image.startsWith("http")?t.image:`${t.image}`,alt:t.title,className:"w-full h-full object-cover transition-transform hover:scale-105",onError:r=>{r.target.src=N}}),t.featured&&e.jsx("div",{className:"absolute top-2 right-2 bg-yellow-400 text-indigo-900 p-1 rounded-full",children:e.jsx(u,{})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:t.title}),e.jsx("p",{className:"text-indigo-600",children:t.category})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>E(t._id),className:`p-2 rounded-full transition-colors ${t.featured?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-500 hover:bg-yellow-50 hover:text-yellow-500"}`,title:t.featured?"Featured":"Set as featured",children:e.jsx(u,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(t),className:"p-2 rounded-full bg-gray-100 text-blue-600 hover:bg-blue-50 transition-colors",title:"Edit",children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D(t._id),className:"p-2 rounded-full bg-gray-100 text-red-600 hover:bg-red-50 transition-colors",title:"Delete",children:e.jsx(L,{className:"w-4 h-4"})})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Added on: ",new Date(t.createdAt).toLocaleDateString()]})]})]},t._id))}),l.length===0&&!f&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(w,{className:"w-12 h-12 mx-auto opacity-30"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"No performers found"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Add your first performer to get started"}),e.jsxs("button",{onClick:()=>c(!0),className:"mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg shadow-sm transition-colors",children:[e.jsx(v,{className:"inline mr-2"})," Add Performer"]})]})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto relative shadow-2xl",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",onClick:j,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:i?"Edit Performer":"Add New Performer"}),e.jsxs("form",{onSubmit:F,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{id:"title",type:"text",value:a.title,onChange:t=>d({...a,title:t.target.value}),placeholder:"Enter Title",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Name"}),e.jsx("input",{id:"category",type:"text",value:a.category,onChange:t=>d({...a,category:t.target.value}),placeholder:"Enter course name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"image",className:"block text-sm font-medium text-gray-700 mb-1",children:"Performer Image"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-indigo-500 transition-colors",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-gray-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:a.imageFile?a.imageFile.name:"Select an image file"}),e.jsx("input",{id:"image",type:"file",accept:"image/*",onChange:S,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",required:!i})]})})]}),a.imagePreview&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Image Preview:"}),e.jsx("div",{className:"relative rounded-lg overflow-hidden border border-gray-200",children:e.jsx("img",{src:a.imagePreview||"/placeholder.svg",alt:"Preview",className:"w-full h-48 object-cover"})})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:j,className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors",children:i?"Update":"Add"})]})]})]})})]})};export{H as default};
