import{j as e,F as S,k as P,f as R,h as j}from"../assets/index-78BcfhOR.js";import{r}from"./chunk-CTJ-xxG2.js";import{a as A}from"./chunk-ngrFHoWO.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-nx6VVHRj.js";const V=()=>{const[w,N]=r.useState([]),[g,c]=r.useState(!1),[k,m]=r.useState(!1),[l,C]=r.useState(null),[n,v]=r.useState({open:!1,type:"",url:""}),[i,x]=r.useState({description:"",name:"",skillLevel:"beginner",video:null,photo:null,thumbnail:null}),d=A.create({baseURL:"https://cpsangeetha.com/api"}),u=t=>t?t.startsWith("http")?t:`${d.defaults.baseURL}/${t.replace(/^\/+/,"")}`:null;r.useEffect(()=>{h()},[]);const h=async()=>{c(!0);try{const t=await d.get("/audienceReview");N(t.data)}catch{alert("Failed to fetch performances")}finally{c(!1)}},L=async t=>{if(confirm("Are you sure you want to delete this performance?"))try{await d.delete(`/audienceReview/${t}`),alert("Performance deleted successfully"),h()}catch{alert("Failed to delete performance")}},o=(t,s)=>{const a=u(s);if(!a){alert("Media URL is invalid");return}v({open:!0,type:t,url:a})},p=t=>{const{name:s,value:a}=t.target;x(f=>({...f,[s]:a}))},b=t=>{const{name:s,files:a}=t.target;x(f=>({...f,[s]:a[0]}))},F=async t=>{t.preventDefault(),c(!0);const s=new FormData;s.append("description",i.description),s.append("name",i.name),s.append("skillLevel",i.skillLevel),i.video&&s.append("video",i.video),i.photo&&s.append("photo",i.photo),i.thumbnail&&s.append("thumbnail",i.thumbnail);try{l?(await d.put(`/audienceReview/${l._id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),alert("Performance updated successfully")):(await d.post("/audienceReview",s,{headers:{"Content-Type":"multipart/form-data"}}),alert("Performance created successfully")),h(),m(!1)}catch(a){alert(`Error saving performance: ${a.message}`)}finally{c(!1)}},y=(t=null)=>{C(t),x({description:(t==null?void 0:t.description)||"",name:(t==null?void 0:t.name)||"",skillLevel:(t==null?void 0:t.skillLevel)||"beginner",video:null,photo:null,thumbnail:null}),m(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Audience Review Management"}),e.jsxs("button",{onClick:()=>y(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center transition-colors duration-200",children:[e.jsx(S,{className:"mr-2"}),"Add review"]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Performer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Media"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Skill Level"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sm:px-6",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-4 text-sm font-medium text-gray-900 sm:px-6 max-w-xs truncate",children:t.description}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:t.name}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-4 space-y-4 sm:space-y-0",children:[t.photo&&e.jsx("div",{className:"relative cursor-pointer group",onClick:()=>o("image",t.photo),children:e.jsx("img",{src:u(t.photo),alt:`${t.description} photo`,className:"w-full max-w-[150px] h-20 object-cover rounded border border-gray-300 group-hover:border-blue-500 transition-colors duration-200"})}),t.video&&e.jsx("div",{className:"relative cursor-pointer group",onClick:()=>o("video",t.video),children:e.jsx("video",{className:"w-full max-w-[150px] h-20 object-cover rounded border border-gray-300 group-hover:border-blue-500 transition-colors duration-200",src:u(t.video),muted:!0,playsInline:!0})}),t.thumbnail&&e.jsx("div",{className:"relative cursor-pointer group",onClick:()=>o("image",t.thumbnail),children:e.jsx("img",{src:u(t.thumbnail),alt:`${t.description} thumbnail`,className:"w-full max-w-[150px] h-20 object-cover rounded border border-gray-300 group-hover:border-blue-500 transition-colors duration-200"})})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.skillLevel==="beginner"?"bg-green-100 text-green-800":t.skillLevel==="intermediate"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.skillLevel.charAt(0).toUpperCase()+t.skillLevel.slice(1)})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-500 sm:px-6",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>y(t),className:"text-blue-600 hover:text-blue-900 transition-colors duration-200","aria-label":"Edit performance",children:e.jsx(P,{})}),e.jsx("button",{onClick:()=>L(t._id),className:"text-red-600 hover:text-red-900 transition-colors duration-200","aria-label":"Delete performance",children:e.jsx(R,{})})]})})]},t._id))})]})})}),n.open&&e.jsx("div",{className:"fixed inset-0 z-150 overflow-y-auto bg-black bg-opacity-75 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg max-w-4xl w-full max-h-[90vh]",children:[e.jsx("button",{onClick:()=>v({open:!1,type:"",url:""}),className:"absolute top-4 right-4 text-gray-600 hover:text-gray-800 z-10 bg-white rounded-full p-2","aria-label":"Close preview",children:e.jsx(j,{className:"h-6 w-6"})}),e.jsx("div",{className:"p-4 h-full",children:n.type==="video"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("video",{controls:!0,autoPlay:!0,className:"w-full max-h-[80vh] rounded",children:[e.jsx("source",{src:n.url,type:"video/mp4"}),"Your browser does not support the video tag."]},n.url)}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("img",{src:n.url,alt:"Preview",className:"max-w-full max-h-[80vh] object-contain rounded"})})})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-md z-140 transition-opacity duration-300 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center p-4 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg w-full max-w-md sm:max-w-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-medium text-gray-900",children:l?"Edit Performance":"Add New Performance"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-600 hover:text-gray-800","aria-label":"Close form",children:e.jsx(j,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("input",{type:"text",name:"description",id:"description",value:i.description,onChange:p,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Performer Name"}),e.jsx("input",{type:"text",name:"name",id:"name",value:i.name,onChange:p,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"skillLevel",className:"block text-sm font-medium text-gray-700",children:"Skill Level"}),e.jsxs("select",{id:"skillLevel",name:"skillLevel",value:i.skillLevel,onChange:p,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"video",className:"block text-sm font-medium text-gray-700",children:["Video File",(l==null?void 0:l.video)&&e.jsx("button",{type:"button",onClick:()=>o("video",l.video),className:"ml-2 text-blue-600 text-xs hover:underline",children:"(View current)"})]}),e.jsx("input",{type:"file",name:"video",id:"video",onChange:b,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"video/*"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"photo",className:"block text-sm font-medium text-gray-700",children:["Photo",(l==null?void 0:l.photo)&&e.jsx("button",{type:"button",onClick:()=>o("image",l.photo),className:"ml-2 text-blue-600 text-xs hover:underline",children:"(View current)"})]}),e.jsx("input",{type:"file",name:"photo",id:"photo",onChange:b,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"image/*"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"thumbnail",className:"block text-sm font-medium text-gray-700",children:["Thumbnail",(l==null?void 0:l.thumbnail)&&e.jsx("button",{type:"button",onClick:()=>o("image",l.thumbnail),className:"ml-2 text-blue-600 text-xs hover:underline",children:"(View current)"})]}),e.jsx("input",{type:"file",name:"thumbnail",id:"thumbnail",onChange:b,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"image/*"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Saving...":l?"Update":"Save"})]})]})]})})]})};export{V as default};
