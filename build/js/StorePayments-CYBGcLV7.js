import{j as e,$ as me,I as ve,e as Ce,C as q,a0 as B,S as Se,a1 as Pe,a2 as V,P as xe,E as ke,a3 as De}from"../assets/index--F2h3LiO.js";import{r as d}from"./chunk-CTJ-xxG2.js";import{a as G}from"./chunk-ngrFHoWO.js";import{R as Oe}from"./chunk-Br5Y37kM.js";import{D as Me}from"./chunk-BiqlrgNu.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-nx6VVHRj.js";const _e=()=>{var ee,te,se,ae,le,ne,re;const[y,w]=d.useState([]),[j,v]=d.useState([]),[A,L]=d.useState(!0),[W,I]=d.useState(null),[f,ue]=d.useState(""),[R,he]=d.useState("all"),[C,pe]=d.useState("all"),[T,ge]=d.useState("all"),[o,H]=d.useState(1),[$]=d.useState(20),[a,Q]=d.useState(null),[ye,P]=d.useState(!1),[E,X]=d.useState({totalPages:0,totalOrders:0,hasNextPage:!1,hasPrevPage:!1}),[S,fe]=d.useState({totalRevenue:0,totalOrders:0,pendingPayments:0,completedPayments:0}),_="https://cpsangeetha.com/api/order",be=async(t=1,l=100)=>{try{L(!0);const s=await G.get(`${_}?page=${t}&limit=${l}`);if(s.data.success){const n=s.data.data||[],i=s.data.pagination||{};t===1?(w(n),v(n),k(n)):(w(r=>[...r,...n]),v(r=>[...r,...n]),k([...y,...n])),X(i),I(null)}else throw new Error(s.data.message||"Failed to fetch orders")}catch(s){console.error("Error fetching store orders:",s),I("Failed to load store orders. Please try again later."),t===1&&(w([]),v([]))}finally{L(!1)}},U=async()=>{try{L(!0);let t=[],l=1,s=!0;for(;s;){const n=await G.get(`${_}?page=${l}&limit=100`);if(n.data.success){const i=n.data.data||[];t=[...t,...i];const r=n.data.pagination||{};s=r.hasNextPage,l++,l===2&&(w(t),v(t),k(t),X(r))}else s=!1}w(t),v(t),k(t),I(null)}catch(t){console.error("Error fetching all orders:",t),I("Failed to load all orders. Please try again later."),w([]),v([])}finally{L(!1)}},k=t=>{const l=t.reduce((r,m)=>r+(m.total||0),0),s=t.length,n=t.filter(r=>b(r).status==="pending").length,i=t.filter(r=>b(r).status==="paid").length;fe({totalRevenue:l,totalOrders:s,pendingPayments:n,completedPayments:i})},J=()=>{let t=[...y];if(f&&(t=t.filter(l=>{var s,n,i,r,m,c,g;return((s=l._id)==null?void 0:s.toLowerCase().includes(f.toLowerCase()))||((i=(n=l.customer)==null?void 0:n.name)==null?void 0:i.toLowerCase().includes(f.toLowerCase()))||((m=(r=l.customerInfo)==null?void 0:r.name)==null?void 0:m.toLowerCase().includes(f.toLowerCase()))||((c=l.phone)==null?void 0:c.toLowerCase().includes(f.toLowerCase()))||((g=l.items)==null?void 0:g.some(h=>{var x,N;return((x=h.name)==null?void 0:x.toLowerCase().includes(f.toLowerCase()))||((N=h.instrumentName)==null?void 0:N.toLowerCase().includes(f.toLowerCase()))}))})),R!=="all"&&(t=t.filter(l=>l.status===R)),C!=="all"&&(t=t.filter(l=>{const s=b(l);return C==="paid"?s.status==="paid":C==="pending"?s.status==="pending":C==="cod"?l.paymentMethod==="cod":C==="refunded"?s.status==="refunded":!0})),T!=="all"){const l=new Date,s=new Date;switch(T){case"today":s.setHours(0,0,0,0),t=t.filter(n=>new Date(n.createdAt)>=s);break;case"week":s.setDate(l.getDate()-7),t=t.filter(n=>new Date(n.createdAt)>=s);break;case"month":s.setMonth(l.getMonth()-1),t=t.filter(n=>new Date(n.createdAt)>=s);break}}v(t),H(1)},D=async(t,l)=>{try{await G.put(`${_}/${t}`,{paymentStatus:l,isAdminAction:!0});const s=y.map(n=>n._id===t?{...n,paymentStatus:l}:n);w(s),J(),k(s),a&&a._id===t&&Q({...a,paymentStatus:l})}catch(s){console.error("Error updating payment status:",s),alert("Failed to update payment status. Please try again.")}},je=()=>{const l=[["Order ID","Customer Name","Phone","Items","Total Amount","Payment Method","Order Status","Date"],...j.map(r=>{var m,c,g,h,x;return[((m=r._id)==null?void 0:m.slice(-8))||"N/A",((c=r.customer)==null?void 0:c.name)||((g=r.customerInfo)==null?void 0:g.name)||"Unknown",((h=r.customerInfo)==null?void 0:h.phone)||r.phone||"N/A",((x=r.items)==null?void 0:x.length)||0,r.total||0,r.paymentMethod||"COD",r.status||"Unknown",new Date(r.createdAt).toLocaleDateString()]})].map(r=>r.join(",")).join(`
`),s=new Blob([l],{type:"text/csv"}),n=window.URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=`store-orders-${new Date().toISOString().split("T")[0]}.csv`,i.click(),window.URL.revokeObjectURL(n)},u=t=>{if(!t||!t.items||!Array.isArray(t.items))return{subtotal:t.total||0,discount:0,tax:0,gst:0,deliveryFee:0,total:t.total||0};if(t.subtotal!==void 0&&t.total!==void 0)return{subtotal:Number(t.subtotal)||0,discount:Number(t.discount)||0,tax:Number(t.tax)||0,gst:Number(t.gst)||0,deliveryFee:Number(t.deliveryFee)||0,total:Number(t.total)||0};let l=0,s=0,n=0,i=0,r=0;t.items.forEach(c=>{const g=Number(c.price)||0,h=Number(c.quantity)||1,x=g*h;l+=x;const N=Number(c.discount)||0,F=N>0?Math.round(x*N/100):0;s+=F;const ie=x-F,de=Number(c.tax)||0,ce=Number(c.gst)||0,oe=Number(c.deliveryFee)||0;de>0&&(n+=Math.round(ie*de/100)),ce>0&&(i+=Math.round(ie*ce/100)),oe>0&&(r+=oe*h)});const m=l-s+n+i+r;return{subtotal:l,discount:s,tax:n,gst:i,deliveryFee:r,total:m}},z=o*$,K=z-$,Y=j.slice(K,z),O=Math.ceil(j.length/$),M=t=>H(t),Ne=async()=>{E.hasNextPage&&!A&&await be(E.currentPage+1,100)},p=t=>`â‚¹${Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,we=t=>new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=t=>{if(t.paymentStatus)switch(t.paymentStatus){case"paid":return{status:"paid",label:"Paid",color:"bg-green-100 text-green-800"};case"pending":return{status:"pending",label:"Pending",color:"bg-yellow-100 text-yellow-800"};case"failed":return{status:"failed",label:"Failed",color:"bg-red-100 text-red-800"};case"refunded":return{status:"refunded",label:"Refunded",color:"bg-purple-100 text-purple-800"};default:return{status:"unknown",label:"Unknown",color:"bg-gray-100 text-gray-800"}}return t.paymentMethod==="cod"?t.status==="delivered"?{status:"paid",label:"Paid (COD)",color:"bg-green-100 text-green-800"}:t.status==="cancelled"?{status:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-800"}:{status:"pending",label:"Pending (COD)",color:"bg-yellow-100 text-yellow-800"}:{status:"paid",label:"Paid Online",color:"bg-green-100 text-green-800"}},Z=t=>{switch(t){case"delivered":return"bg-green-100 text-green-800";case"shipped":return"bg-blue-100 text-blue-800";case"processing":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return d.useEffect(()=>{U()},[]),d.useEffect(()=>{J()},[f,R,C,T,y]),e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Store Payments"}),e.jsxs("p",{className:"text-gray-600",children:["Manage payments for instrument orders and store purchases (",S.totalOrders," total orders)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:U,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Oe,{className:"w-4 h-4"}),"Refresh All"]}),E.hasNextPage&&e.jsxs("button",{onClick:Ne,disabled:A,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[A?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(me,{className:"w-4 h-4"}),"Load More"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border-l-4 border-l-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p(S.totalRevenue)})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(ve,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalOrders}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Showing ",y.length," loaded"]})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Ce,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border-l-4 border-l-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Payments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.pendingPayments})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(q,{className:"w-6 h-6 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border-l-4 border-l-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed Payments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.completedPayments})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(B,{className:"w-6 h-6 text-purple-600"})})]})})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1 w-full",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by order ID, customer name, phone, or instrument...",className:"pl-10 w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:f,onChange:t=>ue(t.target.value)})]}),e.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:R,onChange:t=>he(t.target.value),children:[e.jsx("option",{value:"all",children:"All Order Status"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:C,onChange:t=>pe(t.target.value),children:[e.jsx("option",{value:"all",children:"All Payment Status"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"refunded",children:"Refunded"}),e.jsx("option",{value:"cod",children:"Cash on Delivery"})]}),e.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:T,onChange:t=>ge(t.target.value),children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]})]}),e.jsxs("button",{onClick:je,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Export CSV (",j.length,")"]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[A&&y.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading store orders..."})]}):W?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 mb-4",children:W}),e.jsx("button",{onClick:U,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-gray-500",children:j.length===0&&y.length>0?"No orders match your search criteria.":"No store orders found. When customers place orders, they will appear here."})}):Y.map(t=>{var n,i,r,m,c,g,h,x,N,F;const l=b(t),s=u(t);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",(n=t._id)==null?void 0:n.slice(-8)]}),e.jsx("div",{className:"text-sm text-gray-500",children:t.customerModel||"Customer"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((i=t.customer)==null?void 0:i.name)||((r=t.customerInfo)==null?void 0:r.name)||"Unknown"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[((m=t.items)==null?void 0:m.length)||0," ",((c=t.items)==null?void 0:c.length)===1?"item":"items"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[((h=(g=t.items)==null?void 0:g[0])==null?void 0:h.name)||((N=(x=t.items)==null?void 0:x[0])==null?void 0:N.instrumentName)||"Various items",((F=t.items)==null?void 0:F.length)>1&&` +${t.items.length-1} more`]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-lg font-bold text-green-600",children:p(s.total)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 capitalize",children:t.paymentMethod==="cod"?"Cash on Delivery":t.paymentMethod||"COD"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.color}`,children:l.label})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${Z(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:we(t.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{Q(t),P(!0)},className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",children:[e.jsx(ke,{className:"w-4 h-4"}),"View"]}),l.status==="pending"&&e.jsxs("button",{onClick:()=>D(t._id,"paid"),className:"text-green-600 hover:text-green-900 flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"}),"Mark Paid"]}),l.status==="paid"&&t.paymentMethod==="cod"&&e.jsxs("button",{onClick:()=>D(t._id,"pending"),className:"text-yellow-600 hover:text-yellow-900 flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4"}),"Mark Pending"]})]})})]},t._id)})})]})}),j.length>0&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>o>1&&M(o-1),disabled:o===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>o<O&&M(o+1),disabled:o===O,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:K+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(z,j.length)})," of"," ",e.jsx("span",{className:"font-medium",children:j.length})," results",y.length<S.totalOrders&&e.jsxs("span",{className:"text-blue-600 ml-2",children:["(",y.length," of ",S.totalOrders," total orders loaded)"]})]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsxs("button",{onClick:()=>o>1&&M(o-1),disabled:o===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(De,{className:"h-5 w-5"}),"Previous"]}),[...Array(Math.min(O,5))].map((t,l)=>{const s=l+1;return e.jsx("button",{onClick:()=>M(s),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${o===s?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:s},s)}),e.jsxs("button",{onClick:()=>o<O&&M(o+1),disabled:o===O,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",e.jsx(me,{className:"h-5 w-5"})]})]})})]})]})]}),ye&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Order Details #",(ee=a._id)==null?void 0:ee.slice(-8)]}),e.jsx("button",{onClick:()=>P(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(V,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"Ordered Items (",((te=a.items)==null?void 0:te.length)||0,")"]}),e.jsx("div",{className:"space-y-3",children:(se=a.items)==null?void 0:se.map((t,l)=>e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:t.name||t.instrumentName||`Item ${l+1}`}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",t.quantity||1," Ã— ",p(t.price||0)]}),t.category&&e.jsxs("p",{className:"text-xs text-gray-400",children:["Category: ",t.category]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-bold text-green-600",children:p((t.price||0)*(t.quantity||1))})})]})},l))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(Me,{className:"h-5 w-5 mr-2"}),"Payment Summary"]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"font-medium",children:p(u(a).subtotal)})]}),u(a).discount>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-",p(u(a).discount)]})]}),u(a).tax>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Tax:"}),e.jsx("span",{className:"font-medium",children:p(u(a).tax)})]}),u(a).gst>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"GST:"}),e.jsx("span",{className:"font-medium",children:p(u(a).gst)})]}),u(a).deliveryFee>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Delivery Fee:"}),e.jsx("span",{className:"font-medium",children:p(u(a).deliveryFee)})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{className:"text-green-600",children:p(u(a).total)})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Customer & Delivery Information"}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Customer:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:((ae=a.customer)==null?void 0:ae.name)||((le=a.customerInfo)==null?void 0:le.name)||"Unknown"})]}),(((ne=a.customerInfo)==null?void 0:ne.phone)||a.phone)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Phone:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:((re=a.customerInfo)==null?void 0:re.phone)||a.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Delivery Address:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:a.address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Payment Method:"}),e.jsx("p",{className:"text-gray-600 mt-1 capitalize",children:a.paymentMethod==="cod"?"Cash on Delivery":a.paymentMethod||"COD"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Payment Status:"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(a).color}`,children:b(a).label})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Order Status:"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${Z(a.status)}`,children:a.status})})]}),a.trackingId&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Tracking ID:"}),e.jsx("p",{className:"text-gray-600 mt-1 font-mono",children:a.trackingId})]}),a.cancellationReason&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-red-700",children:"Cancellation Reason:"}),e.jsx("p",{className:"text-red-600 mt-1",children:a.cancellationReason})]})]})]})]})]})}),e.jsx("div",{className:"p-6 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",onClick:()=>P(!1),children:"Close"}),e.jsxs("div",{className:"flex gap-2",children:[b(a).status==="pending"&&e.jsxs("button",{onClick:()=>{D(a._id,"paid"),P(!1)},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Mark as Paid"]}),b(a).status==="paid"&&a.paymentMethod==="cod"&&e.jsxs("button",{onClick:()=>{D(a._id,"pending"),P(!1)},className:"bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"Mark as Pending"]}),b(a).status==="paid"&&e.jsxs("button",{onClick:()=>{D(a._id,"refunded"),P(!1)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"Mark as Refunded"]})]})]})})]})})]})})};export{_e as default};
