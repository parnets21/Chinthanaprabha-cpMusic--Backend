import{j as e,F as q,f as T}from"../assets/index-DYNONSj5.js";import{r as l}from"./chunk-CTJ-xxG2.js";import{a as b}from"./chunk-ngrFHoWO.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-nx6VVHRj.js";const y="https://cpsangeetha.com/chinthanaprabha/user-auth",K=()=>{const[c,P]=l.useState([]),[E,k]=l.useState(!0),[M,C]=l.useState(null),[U,h]=l.useState(!1),[a,$]=l.useState(null),[m,A]=l.useState(""),[o,x]=l.useState(1),[j]=l.useState(10),[S,g]=l.useState("");l.useEffect(()=>{N()},[]);const N=async()=>{try{k(!0);const t=await b.get(`${y}/users`);P(t.data.users||[]),C(null)}catch(t){console.error("Error fetching users:",t),C("Failed to load users. Please try again later.")}finally{k(!1)}},V=()=>{A("add"),$(null),g(""),h(!0)},D=async t=>{if(confirm(`Are you sure you want to delete ${t.name}?`))try{await b.delete(`${y}/user/${t._id}`),P(c.filter(i=>i._id!==t._id)),alert("User deleted successfully")}catch(i){console.error("Error deleting user:",i),alert("Failed to delete user. Please try again.")}},_=async t=>{var i,f;t.preventDefault(),g("");try{if(m==="add"){const s=t.target.name.value,r=t.target.email.value,d=t.target.phone.value;if(!s||!r||!d){g("All fields are required");return}const v={name:s,email:r,mobile:d},u=await b.post(`${y}/register`,v);console.log("User added successfully:",u.data),h(!1),N()}else if(m==="edit"){const s=new FormData(t.target),r=s.get("name"),d=s.get("email"),v=s.get("phone"),u=s.get("profilePicFile"),p=new FormData;p.append("name",r),p.append("email",d),p.append("mobile",v),u&&u.size>0&&p.append("profilePicture",u);const R=await b.put(`${y}/user/update/${a._id}`,p,{headers:{"Content-Type":"multipart/form-data"}});console.log("User updated successfully:",R.data),h(!1),N()}}catch(s){console.error("Error submitting user data:",s),g(((f=(i=s.response)==null?void 0:i.data)==null?void 0:f.message)||"Failed to save user data. Please try again.")}};if(E)return e.jsx("div",{className:"p-6 text-center",children:"Loading users..."});if(M)return e.jsx("div",{className:"p-6 text-center text-red-500",children:M});const w=o*j,F=w-j,z=c.slice(F,w),n=Math.ceil(c.length/j),L=()=>{const t=[],f=Math.floor(2.5);let s=Math.max(o-f,1);const r=Math.min(s+5-1,n);r-s+1<5&&(s=Math.max(r-5+1,1)),s>1&&(t.push(1),s>2&&t.push("..."));for(let d=s;d<=r;d++)t.push(d);return r<n&&(r<n-1&&t.push("..."),t.push(n)),t};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"User Management"}),e.jsxs("button",{onClick:V,className:"bg-black text-white px-4 py-2 rounded-lg flex items-center",children:[e.jsx(q,{className:"mr-2"})," Add New User"]})]}),e.jsx("div",{className:"relative overflow-x-auto pb-4 scroll-container",children:e.jsx("div",{className:"min-w-[800px]",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider",children:"Profile"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:z.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:t.image?`${t.image}`:"/placeholder.svg",className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full object-cover",alt:"Profile"})})}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-center truncate max-w-[120px]",children:t._id}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-center",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 text-center truncate",children:t.email}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:t.mobile}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:"flex justify-center space-x-2",children:e.jsx("button",{onClick:()=>D(t),className:"text-red-600 hover:text-red-800 p-1 rounded-full hover:bg-red-50",children:e.jsx(T,{size:18})})})})]},t._id))})]})})}),e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 mt-4",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>x(t=>Math.max(t-1,1)),disabled:o===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>x(t=>Math.min(t+1,n)),disabled:o===n,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:F+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(w,c.length)})," ","of ",e.jsx("span",{className:"font-medium",children:c.length})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>x(t=>Math.max(t-1,1)),disabled:o===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),L().map((t,i)=>t==="..."?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."},`ellipsis-${i}`):e.jsx("button",{onClick:()=>x(t),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${o===t?"z-10 bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:t},t)),e.jsxs("button",{onClick:()=>x(t=>Math.min(t+1,n)),disabled:o===n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})]}),U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-left",children:m==="add"?"Add New User":"Edit User"}),S&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:S}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[m==="edit"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left text-gray-700",children:"Profile Picture"}),e.jsx("input",{name:"profilePicFile",type:"file",accept:"image/*",className:"mt-1 w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(a==null?void 0:a.image)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Current image:"}),e.jsx("img",{src:`${a.image}`,alt:"Current profile",className:"w-16 h-16 rounded-full object-cover mt-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left text-gray-700",children:"Name"}),e.jsx("input",{name:"name",type:"text",defaultValue:a==null?void 0:a.name,className:"mt-1 w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left text-gray-700",children:"Email"}),e.jsx("input",{name:"email",type:"email",defaultValue:a==null?void 0:a.email,className:"mt-1 w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-left text-gray-700",children:"Phone"}),e.jsx("input",{name:"phone",type:"tel",defaultValue:a==null?void 0:a.mobile,className:"mt-1 w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:m==="add"?"Add User":"Update User"}),e.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 bg-gray-100 text-gray-600 px-4 py-2 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-300",children:"Cancel"})]})]})]})})]})};export{K as default};
