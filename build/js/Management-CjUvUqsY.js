import{j as e,i as Pe,k as Ue,f as pe,l as Te,F as Le}from"../assets/index-5RbimExn.js";import{r as m}from"./chunk-CTJ-xxG2.js";import{a as f}from"./chunk-ngrFHoWO.js";import"./chunk-DS08_OVb.js";import"./chunk-Cjtwp2vM.js";import"./chunk-nx6VVHRj.js";const Ge=()=>{var ue,he,xe;const[b,E]=m.useState([]),[M,I]=m.useState(!0),[P,Z]=m.useState(""),[K,ee]=m.useState([]),[D,se]=m.useState(!1),[U,te]=m.useState(""),[ge,N]=m.useState(!1),[g,B]=m.useState(""),[c,_]=m.useState(null),[o,p]=m.useState({name:"",description:"",price:"",instructor:"",image:null,lessons:[{videoFiles:[],lessonNumber:"",lessonIntro:""}]}),[z,re]=m.useState({}),[T,q]=m.useState({}),[L,G]=m.useState({}),[A,R]=m.useState({}),[ae,W]=m.useState({}),[oe,ne]=m.useState({}),[F,ie]=m.useState(!1),[O,C]=m.useState(0),[k,le]=m.useState(0),[v,fe]=m.useState(1),[Y]=m.useState(5);m.useEffect(()=>{H(),ye()},[]);const ce=async(s,t,r)=>{const n=Date.now(),h=s.size;re(a=>({...a,[t]:!0})),q(a=>({...a,[t]:0})),G(a=>({...a,[t]:0})),R(a=>({...a,[t]:0})),W(a=>({...a,[t]:0})),ne(a=>({...a,[t]:h}));try{const a=new FormData;return a.append("video",s),(await f.post(r,a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:d=>{const l=d.loaded,u=d.total,x=Math.round(l*100/u),$=(Date.now()-n)/1e3,Q=l/$,Ie=(u-l)/Q;q(w=>({...w,[t]:x})),G(w=>({...w,[t]:Q})),R(w=>({...w,[t]:Ie})),W(w=>({...w,[t]:l}))}})).data.location}catch(a){throw console.error("Video upload error:",a),a}finally{re(a=>({...a,[t]:!1})),setTimeout(()=>{q(a=>({...a,[t]:0})),G(a=>({...a,[t]:0})),R(a=>({...a,[t]:0})),W(a=>({...a,[t]:0})),ne(a=>({...a,[t]:0}))},3e3)}},be=async(s,t)=>{try{const r=Array.from(t.target.files);if(!r.length)return;const n=[],h=[];if(r.forEach(a=>{if(!a.type.startsWith("video/")){h.push(`${a.name} - Not a video file`);return}if(a.size>10*1024*1024*1024){h.push(`${a.name} - File too large (max 10GB)`);return}n.push(a)}),h.length>0&&alert(`Invalid files:
${h.join(`
`)}`),n.length>0){const a=[];for(let i=0;i<n.length;i++){const d=n[i],l=`lesson-${s}-file-${i}`;try{const u=await ce(d,l,"https://cpsangeetha.com/chinthanaprabha/upload-video");a.push({...d,url:u})}catch(u){console.error(`Failed to upload ${d.name}:`,u),alert(`Failed to upload ${d.name}. Please try again.`)}}a.length>0&&(p(i=>({...i,lessons:i.lessons.map((d,l)=>l===s?{...d,videoFiles:[...d.videoFiles||[],...a]}:d)})),a.length===1?alert(`Successfully uploaded: ${a[0].name}`):alert(`Successfully uploaded ${a.length} video files`))}t.target.value=""}catch(r){console.error("Error handling video file change:",r),alert("Error adding video files. Please try again.")}},ve=(s,t)=>{try{p(r=>({...r,lessons:r.lessons.map((n,h)=>h===s?{...n,videoFiles:(n.videoFiles||[]).filter((a,i)=>i!==t)}:n)}))}catch(r){console.error("Error removing video file:",r),alert("Error removing video file. Please try again.")}},je=s=>{try{window.confirm("Are you sure you want to remove all videos from this lesson?")&&p(t=>({...t,lessons:t.lessons.map((r,n)=>n===s?{...r,videoFiles:[]}:r)}))}catch(t){console.error("Error clearing all videos:",t),alert("Error clearing videos. Please try again.")}},j=async s=>{try{const t=await s;return console.log("API Response:",t.data),t}catch(t){throw console.error("API Error:",t.response?t.response.data:t.message),t}};m.useEffect(()=>{if(!F)return;let s,t=performance.now();const r=n=>{const h=Math.min(1e3,n-t);t=n;const a=O>=95?100:95,i=Math.max(O,Math.min(a,k+h/1e3*3)),d=k+(i-k)*.2;le(d),s=requestAnimationFrame(r)};return s=requestAnimationFrame(r),()=>cancelAnimationFrame(s)},[F,O,k]);const H=async()=>{try{console.log("Starting to fetch courses..."),I(!0),Z("");const s=await j(f.get("https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses"));console.log("Courses fetched successfully:",s.data.length,"courses"),E(s.data)}catch(s){console.error("Error fetching courses:",s),Z("Failed to load courses")}finally{I(!1)}},ye=async()=>{var s,t;try{se(!0),te("");const r=await j(f.get("https://cpsangeetha.com/chinthanaprabha/teacher-auth/teachers"));ee(r.data||[])}catch(r){console.error("Error fetching teachers:",r),te(((t=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load instructors"),ee([])}finally{se(!1)}},de=v*Y,Ne=de-Y,we=b.slice(Ne,de),V=Math.ceil(b.length/Y),y=async(s,t=-1)=>{const{name:r,value:n,type:h,files:a}=s.target;if(h==="file"){if(r==="image")p({...o,[r]:a[0]});else if(r==="courseVideo"&&a[0])try{const i=await ce(a[0],"course-video","https://cpsangeetha.com/chinthanaprabha/upload-video");p({...o,courseVideoUrl:i}),alert(`Course video uploaded successfully: ${a[0].name}`)}catch(i){console.error("Failed to upload course video:",i),alert("Failed to upload course video. Please try again.")}}else if(t===-1)p({...o,[r]:n});else{const i=[...o.lessons];i[t][r]=n,p({...o,lessons:i})}},Fe=()=>{p({...o,lessons:[...o.lessons,{videoFiles:[],lessonNumber:"",lessonIntro:""}]})},Ce=s=>{const t=o.lessons.filter((r,n)=>n!==s);p({...o,lessons:t})},ke=()=>{B("add"),_(null),p({name:"",description:"",price:"",instructor:"",image:null,lessons:[{videoUrls:[],lessonNumber:"",lessonIntro:""}]}),N(!0)},Se=s=>{var r;console.log("Editing course:",s);const t=s.lessons.map(n=>({lessonNumber:n.lessonNumber||"",lessonIntro:n.lessonIntro||"",videoFiles:[],_id:n._id}));p({name:s.name||"",description:s.description||"",price:s.price||"",instructor:((r=s.instructor)==null?void 0:r._id)||s.instructor||"",image:null,currentImage:s.image,lessons:t.length>0?t:[{videoFiles:[],lessonNumber:"",lessonIntro:""}]}),_(s),B("edit"),N(!0)},Me=s=>{_({...s}),B("view"),N(!0)},$e=async s=>{if(confirm("Are you sure you want to delete this course?"))try{await f.delete(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${s}`),E(b.filter(t=>t._id!==s))}catch(t){console.error("Error deleting course:",t)}},Ee=async s=>{var t,r;if(s.preventDefault(),!o.name||!o.description||!o.price||!o.instructor){alert("Please fill in all required fields (Name, Description, Price, Instructor)");return}if(!o.image){alert("Please select a course image");return}console.log("Form data validation passed:",{name:o.name,description:o.description,price:o.price,instructor:o.instructor,hasImage:!!o.image,imageType:(t=o.image)==null?void 0:t.type,imageSize:(r=o.image)==null?void 0:r.size});try{ie(!0),C(0),le(0);let h=1+o.lessons.filter(i=>i.videoFiles&&i.videoFiles.length>0).length;if(g==="edit"){const i=o.lessons.filter(l=>l._id&&l.videoFiles&&l.videoFiles.length>0).length,d=o.lessons.filter(l=>!l._id&&l.videoFiles&&l.videoFiles.length>0).length;h=1+i+d}let a=0;if(g==="add"){const i=new FormData;if(i.append("name",o.name),i.append("description",o.description),i.append("price",o.price),i.append("instructor",o.instructor),o.image)i.append("image",o.image);else{console.error("Course image is required"),alert("Please select a course image");return}o.courseVideoUrl&&i.append("videoUrl",o.courseVideoUrl),console.log("Creating course with data:",{name:o.name,description:o.description,price:o.price,instructor:o.instructor,hasImage:!!o.image});const l=(await j(f.post("https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses",i,{headers:{"Content-Type":"multipart/form-data"}}))).data._id;a+=1,C(Math.round(a/Math.max(h,1)*100));for(const u of o.lessons)if(u.videoFiles&&u.videoFiles.length>0){const x=new FormData;x.append("lessonNumber",u.lessonNumber),x.append("lessonIntro",u.lessonIntro),u.videoFiles.forEach(($,Q)=>{x.append("video",$)}),await j(f.post(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${l}/lessons`,x,{headers:{"Content-Type":"multipart/form-data"}})),a+=1,C(Math.round(a/Math.max(h,1)*100))}}else if(g==="edit"){const i=c._id;try{const d=new FormData;d.append("name",o.name),d.append("description",o.description),d.append("price",o.price),d.append("instructor",o.instructor),o.image&&d.append("image",o.image),await j(f.put(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${i}`,d,{headers:{"Content-Type":"multipart/form-data"}})),a+=1,C(Math.round(a/Math.max(h,1)*100));for(const l of o.lessons)if(l._id){if(l.videoFiles&&l.videoFiles.length>0){const u=new FormData;u.append("lessonNumber",l.lessonNumber),u.append("lessonIntro",l.lessonIntro),l.videoFiles.forEach((x,$)=>{u.append("video",x)}),await j(f.put(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/lessons/${l._id}`,u,{headers:{"Content-Type":"multipart/form-data"}})),a+=1,C(Math.round(a/Math.max(h,1)*100))}}else if(l.videoFiles&&l.videoFiles.length>0){const u=new FormData;u.append("lessonNumber",l.lessonNumber),u.append("lessonIntro",l.lessonIntro),l.videoFiles.forEach((x,$)=>{u.append("video",x)}),await j(f.post(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/courses/${i}/lessons`,u,{headers:{"Content-Type":"multipart/form-data"}})),a+=1,C(Math.round(a/Math.max(h,1)*100))}if(c.lessons){const l=o.lessons.filter(x=>x._id).map(x=>x._id),u=c.lessons.filter(x=>!l.includes(x._id));for(const x of u)console.log(`Deleting lesson ${x._id}`),await j(f.delete(`https://cpsangeetha.com/chinthanaprabha/courses-lessons/lessons/${x._id}`))}console.log("Course updated successfully")}catch(d){console.error("Error updating course:",d),alert("There was an error updating the course. Please try again.")}}g==="add"?(alert("Course added successfully!"),p({name:"",description:"",price:"",instructor:"",image:null,lessons:[{videoFiles:[],lessonNumber:"",lessonIntro:""}]})):g==="edit"&&alert("Course updated successfully!"),N(!1),console.log("Refreshing course list..."),await H(),console.log("Course list refreshed successfully")}catch(n){console.error("Error saving course:",n),alert("Error saving course. Please check the console for details.")}finally{ie(!1)}},J=s=>{fe(s)},S=s=>{if(s===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,n)).toFixed(2))+" "+r[n]},me=s=>s<60?`${Math.round(s)}s`:s<3600?`${Math.round(s/60)}m ${Math.round(s%60)}s`:`${Math.round(s/3600)}h ${Math.round(s%3600/60)}m`;return m.useEffect(()=>{console.log("Management component rendered, courses:",b.length,"loading:",M,"error:",P)},[b,M,P]),e.jsxs("div",{className:"h-screen p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Course Management"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("button",{onClick:ke,className:"bg-black text-white px-4 py-2 rounded",children:"Add New Course"})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:M?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"Loading courses..."})}):P?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:P}),e.jsx("button",{onClick:H,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Retry"})]}):b.length===0?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No courses found. Add your first course!"})}):e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-800 text-white",children:[e.jsx("th",{className:"w-16 px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Image"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Instructor"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Videos"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Lessons"}),e.jsx("th",{className:"w-20 px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"w-32 px-4 py-2 text-center text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:we.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-gray-100 transition-colors duration-200",children:[e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",s._id.substring(0,6)]}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx(X,{image:s.image,name:s.name})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:((t=s.instructor)==null?void 0:t.name)||s.instructor||"N/A"}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-indigo-600",children:s.lessons.reduce((r,n)=>r+(n.videoUrls?n.videoUrls.length:0),0)}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-indigo-600",children:s.lessons.length}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-bold text-gray-900",children:["₹ ",s.price]}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right text-sm font-medium space-x-3",children:[e.jsx("button",{onClick:()=>Me(s),className:"text-indigo-600 hover:text-indigo-900",children:e.jsx(Pe,{size:18})}),e.jsx("button",{onClick:()=>Se(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(Ue,{size:18})}),e.jsx("button",{onClick:()=>$e(s._id),className:"text-red-600 hover:text-red-900",children:e.jsx(pe,{size:18})})]})]},s._id)})})]})}),e.jsx("div",{className:"flex lg:justify-end justify start mt-4 mb-4 pr-4",children:e.jsxs("nav",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>J(Math.max(1,v-1)),disabled:v===1,className:`px-3 py-1 mx-1 rounded ${v===1?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:"Previous"}),Array.from({length:V},(s,t)=>t+1).map(s=>e.jsx("button",{onClick:()=>J(s),className:`px-3 py-1 mx-1 rounded ${v===s?"bg-black text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:s},s)),e.jsx("button",{onClick:()=>J(Math.min(V,v+1)),disabled:v===V,className:`px-3 py-1 mx-1 rounded ${v===V?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:"Next"})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg shadow-xl transform transition-all overflow-y-auto max-h-[85vh] relative",children:[e.jsx("button",{onClick:()=>N(!1),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 focus:outline-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 text-left",children:g==="view"?"Course Details":g==="add"?"Add New Course":"Edit Course"}),g==="view"&&c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Course Image"}),e.jsx(X,{image:c.image,name:c.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Course Name"}),e.jsx("p",{children:c.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"About Guru"}),e.jsx("p",{children:c.description})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Instructor"}),e.jsx("p",{children:((ue=c.instructor)==null?void 0:ue.name)||c.instructor||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Price"}),e.jsxs("p",{children:["₹",c.price]})]}),c.videoUrl&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Course Preview Video"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2 truncate",children:c.videoUrl}),e.jsx("div",{className:"relative w-full h-64 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("iframe",{src:getYouTubeEmbedUrl(c.videoUrl),title:"Course Preview Video",className:"absolute inset-0 w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Lessons"}),e.jsx("ul",{className:"list-disc pl-5",children:(he=c==null?void 0:c.lessons)==null?void 0:he.map((s,t)=>e.jsxs("li",{children:["Lesson ",s.lessonNumber,": ",s.lessonIntro]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-left",children:"Videos"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 mt-2",children:(xe=c==null?void 0:c.lessons)==null?void 0:xe.flatMap(s=>{var t;return(t=s.videoUrls)==null?void 0:t.map((r,n)=>e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[s.lessonNumber," - Video ",n+1]}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:r})]}),e.jsx("div",{className:"relative w-full h-64 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("iframe",{src:getYouTubeEmbedUrl(r),title:`YouTube video ${n+1}`,className:"absolute inset-0 w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]},n))})}),(!(c!=null&&c.lessons)||c.lessons.length===0||c.lessons.every(s=>!s.videoUrls||s.videoUrls.length===0))&&e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"No videos available for this course."})]}),e.jsx("button",{onClick:()=>N(!1),className:"w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Close"})]}):e.jsxs("form",{onSubmit:Ee,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Course Image"}),e.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:y,className:"mt-1"}),g==="edit"&&o.currentImage&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Current image:"}),e.jsx(X,{image:o.currentImage,name:o.name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Course Preview Video (Optional)"}),e.jsx("input",{type:"file",name:"courseVideo",accept:"video/*",onChange:y,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload a preview video for the course (up to 10GB)"}),z["course-video"]&&e.jsxs("div",{className:"mt-3 bg-blue-50 p-3 rounded border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Uploading course video..."}),e.jsxs("span",{className:"text-xs text-blue-600",children:[T["course-video"]||0,"%"]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${T["course-video"]||0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-blue-600",children:[e.jsxs("span",{children:[S(ae["course-video"]||0)," / ",S(oe["course-video"]||0)]}),e.jsx("span",{children:L["course-video"]?`${S(L["course-video"])}/s`:"0 B/s"}),e.jsxs("span",{children:["ETA: ",A["course-video"]?me(A["course-video"]):"0s"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Course Name"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:y,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"About Guru"}),e.jsx("textarea",{name:"description",value:o.description,onChange:y,rows:3,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Instructor"}),e.jsxs("select",{name:"instructor",value:o.instructor,onChange:y,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:D?"Loading instructors...":"Select an instructor"}),U&&e.jsx("option",{value:"",disabled:!0,children:U}),!D&&!U&&K.length===0&&e.jsx("option",{value:"",disabled:!0,children:"No instructors found"}),!D&&!U&&K.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Price"}),e.jsx("input",{type:"number",name:"price",value:o.price,onChange:y,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Lessons"}),o.lessons.map((s,t)=>e.jsxs("div",{className:"mt-4 p-4 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:"text-lg font-medium text-left",children:["Lesson ",t+1]}),e.jsx("button",{type:"button",onClick:()=>Ce(t),className:"text-red-600 hover:text-red-800",children:e.jsx(Te,{})})]}),e.jsx("input",{type:"text",placeholder:"Lesson Number",value:s.lessonNumber,onChange:r=>y(r,t),name:"lessonNumber",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 mb-2",required:!0}),e.jsx("input",{type:"text",placeholder:"Lesson Intro",value:s.lessonIntro,onChange:r=>y(r,t),name:"lessonIntro",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 mb-2",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-left",children:"Video Files (Up to 10GB each)"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"file",accept:"video/*",multiple:!0,onChange:r=>be(t,r),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload multiple video files. Each file can be up to 10GB. Formats: MP4, AVI, MOV, etc."})]}),Object.keys(z).some(r=>r.startsWith(`lesson-${t}-`))&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Uploading Videos..."}),Object.keys(z).filter(r=>r.startsWith(`lesson-${t}-`)).map(r=>e.jsxs("div",{className:"bg-blue-50 p-3 rounded border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Uploading video..."}),e.jsxs("span",{className:"text-xs text-blue-600",children:[T[r]||0,"%"]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${T[r]||0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-blue-600",children:[e.jsxs("span",{children:[S(ae[r]||0)," / ",S(oe[r]||0)]}),e.jsx("span",{children:L[r]?`${S(L[r])}/s`:"0 B/s"}),e.jsxs("span",{children:["ETA: ",A[r]?me(A[r]):"0s"]})]})]},r))]}),s.videoFiles&&s.videoFiles.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Added Videos (",s.videoFiles.length,"):"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500 bg-blue-100 px-2 py-1 rounded",children:["Total: ",(s.videoFiles||[]).reduce((r,n)=>r+(n.size||0),0)>1024*1024*1024?`${((s.videoFiles||[]).reduce((r,n)=>r+(n.size||0),0)/(1024*1024*1024)).toFixed(2)} GB`:`${((s.videoFiles||[]).reduce((r,n)=>r+(n.size||0),0)/(1024*1024)).toFixed(2)} MB`]}),s.videoFiles.length>1&&e.jsx("button",{type:"button",onClick:()=>je(t),className:"text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 transition-colors",title:"Clear all videos",children:"Clear All"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-60 overflow-y-auto",children:s.videoFiles.map((r,n)=>{var h;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded border hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-600 truncate font-medium",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:(r.size||0)>1024*1024*1024?`${((r.size||0)/(1024*1024*1024)).toFixed(2)} GB`:`${((r.size||0)/(1024*1024)).toFixed(2)} MB`}),e.jsx("span",{className:"text-xs text-gray-400",children:"•"}),e.jsx("span",{className:"text-xs text-gray-500",children:((h=(r.type||"").split("/")[1])==null?void 0:h.toUpperCase())||"VIDEO"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["#",n+1]}),e.jsx("button",{type:"button",onClick:()=>ve(t,n),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50 transition-colors",title:"Remove video",children:e.jsx(pe,{size:14})})]})]},n)})})]})]})]},t)),e.jsxs("button",{type:"button",onClick:Fe,className:"mt-2 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:[e.jsx(Le,{className:"inline-block mr-2"})," Add Lesson"]})]}),e.jsxs("div",{className:"flex space-x-3 items-center",children:[e.jsx("button",{type:"submit",disabled:F,className:`flex-1 px-4 py-2 rounded text-white ${F?"bg-blue-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:F?`${g==="add"?"Adding":"Updating"}... ${Math.round(k)}%`:g==="add"?"Add Course":"Update Course"}),F&&e.jsx("div",{className:"w-40",children:e.jsx("div",{className:"h-2 bg-gray-200 rounded overflow-hidden",children:e.jsx("div",{className:"h-2 bg-blue-600 rounded transition-all duration-300 ease-out",style:{width:`${Math.round(k)}%`}})})}),e.jsx("button",{type:"button",onClick:()=>N(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})]})})]})},X=({image:b,name:E})=>{const[M,I]=m.useState(!1);return e.jsx("img",{src:M||!b?"/placeholder.svg":`${b}`,alt:E,className:"h-10 w-10 rounded-full",onError:()=>I(!0)})};export{Ge as default};
